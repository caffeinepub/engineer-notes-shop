{
  "kind": "build_request",
  "title": "Fix owner access auto-assignment for authenticated Google user",
  "projectName": "Engineer Notes Shop",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the backend auto-owner assignment logic so that the authenticated principal 'hmeax-fs32k-burgh-dx5q3-cud51-d77j7-y6kwa-fl2po-zzjpj-c74c2-rae' (shrirangatre@gmail.com) is correctly granted owner/admin access when they are the first authenticated user",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2",
          "msg-3"
        ],
        "quotes": [
          "Owner access not available to shrirangatre@gmail.com",
          "Admin Check: ✗ Not admin",
          "Access Denied - You do not have permission to access the admin dashboard"
        ]
      },
      "acceptanceCriteria": [
        "When the user with principal 'hmeax-fs32k-burgh-dx5q3-cud51-d77j7-y6kwa-fl2po-zzjpj-c74c2-rae' logs in, the Admin Diagnostics panel shows 'Admin Check: ✓ Admin' instead of '✗ Not admin'",
        "The Access Denied screen no longer appears when this authenticated user navigates to the admin dashboard",
        "The admin system correctly recognizes this principal as the owner upon first authentication",
        "The 'Initialize as Owner' button either works correctly or is removed if auto-assignment is functioning"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Ensure the isCallerAdmin() backend method returns true for the owner principal 'hmeax-fs32k-burgh-dx5q3-cud51-d77j7-y6kwa-fl2po-zzjpj-c74c2-rae' so that admin checks pass on the frontend",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Admin Check: ✗ Not admin",
          "Products Query: N/A (not admin)"
        ]
      },
      "acceptanceCriteria": [
        "The Admin Diagnostics panel shows 'Admin Check: ✓ Admin' with a green checkmark",
        "The Products Query section displays product data instead of 'N/A (not admin)'",
        "All admin-gated features become accessible to this authenticated user"
      ]
    },
    {
      "id": "REQ-3",
      "text": "If the 'Initialize as Owner' button is retained, ensure it correctly assigns owner access to the authenticated principal when clicked, or remove it entirely if auto-assignment on first authentication is working correctly",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "Shows the 'Initialize as Owner' button is available",
          "Initialize as Owner button present but non-functional"
        ]
      },
      "acceptanceCriteria": [
        "Either the button successfully grants owner access when clicked and shows a success confirmation",
        "Or the button is removed from the Access Denied screen if auto-assignment on login is working",
        "The user experience is clear and does not present non-functional UI elements"
      ]
    }
  ],
  "constraints": [
    "Do not change the authentication principal - it must remain 'hmeax-fs32k-burgh-dx5q3-cud51-d77j7-y6kwa-fl2po-zzjpj-c74c2-rae'",
    "Do not modify the Internet Identity integration or authentication flow",
    "Preserve the Admin Diagnostics panel structure and all diagnostic information fields",
    "Keep the profile name 'shrirangatre@gmail.com' associated with this principal"
  ],
  "nonGoals": [
    "Adding new admin users or multi-user admin management",
    "Changing the UI design or layout of the Admin Dashboard",
    "Modifying the product management features or CRUD operations",
    "Implementing role-based access control beyond owner/admin designation",
    "Changing how authentication principals are generated or stored"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}