{
  "kind": "build_request",
  "title": "Fix product visibility in category section and storefront",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the backend getProductsByCategory function to ensure all published products are returned and included in the category listings",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "admin dashboard is showing one product uploaded, but it is not available in category section"
        ]
      },
      "acceptanceCriteria": [
        "Products that appear in admin dashboard are returned by getProductsByCategory when published",
        "Products with valid category assignments appear in their respective category listings",
        "Both draft and live pages show the same products when published"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Verify and fix the product publish/unpublish logic to ensure published products are visible in storefront queries",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "it is not available in category section of draft and live page"
        ]
      },
      "acceptanceCriteria": [
        "Published products immediately appear in category listings",
        "Unpublished products are hidden from storefront but visible in admin dashboard",
        "The isPublished flag is correctly checked in all storefront queries"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add validation to ensure products must have a price value set before they can be published and made visible",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "price of product and purchase options need to be updated"
        ]
      },
      "acceptanceCriteria": [
        "Products without a price cannot be published",
        "Admin dashboard shows clear validation error when attempting to publish a product without a price",
        "Products with price set to zero or null are treated as invalid"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Update the admin dashboard to display product price and show validation warnings if price is missing or invalid before publishing",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "price of product and purchase options need to be updated"
        ]
      },
      "acceptanceCriteria": [
        "Admin dashboard displays the current price for each product",
        "Warning badge appears on products without valid prices",
        "Publish button is disabled or shows warning for products without prices"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Add admin UI functionality to edit product price and purchase options before publishing",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "price of product and purchase options need to be updated"
        ]
      },
      "acceptanceCriteria": [
        "Admin can set or update product price through the dashboard",
        "Price input validates numeric values and prevents invalid entries",
        "Changes to price are immediately reflected in the product data"
      ]
    },
    {
      "id": "REQ-6",
      "text": "Investigate and fix the specific case where the one uploaded product is not appearing in category listings despite being visible in admin dashboard",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-latest"
        ],
        "quotes": [
          "admin dashboard is showing one product uploaded, but it is not available in category section"
        ]
      },
      "acceptanceCriteria": [
        "The specific uploaded product appears in its assigned category on both draft and live pages",
        "Product data consistency is verified between admin view and public storefront",
        "Query cache invalidation works correctly after product updates"
      ]
    }
  ],
  "constraints": [
    "Maintain existing payment integration architecture",
    "Do not modify the Internet Identity authentication system",
    "Preserve existing admin authorization checks",
    "Keep the current product data structure compatible with existing purchases"
  ],
  "nonGoals": [
    "Implementing new payment gateway providers",
    "Redesigning the admin dashboard layout",
    "Adding bulk product import functionality",
    "Changing the category structure or hierarchy"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}